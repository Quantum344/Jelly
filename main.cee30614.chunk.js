(this["webpackJsonpchatcrypt-pwa"]=this["webpackJsonpchatcrypt-pwa"]||[]).push([[0],{107:function(e,t,n){"use strict";(function(e){var s=n(34),a=n(22),i=n(24),r=n(11),o=n(12),c=n(7),l=n(14),h=n(13),u=n(0),p=n.n(u),d=n(5),m=n(121),g=n(87),v=n(108),f=n(117),b=n(118),y=n(116),E=n(114);g.a.initialize("UA-74823759-36");var S=function(t){Object(l.a)(u,t);var n=Object(h.a)(u);function u(e){var t;Object(r.a)(this,u),(t=n.call(this,e)).state={drawerVisible:!1,activeRoute:"enter",routeEvents:{},channels:[],settings:{send:!0,notifications:!1,sounds:!1}},t.rootRef=p.a.createRef(),t.viewportResizeUpdate=!1,t.viewportResize=t.viewportResize.bind(Object(c.a)(t)),t.showDrawer=t.showDrawer.bind(Object(c.a)(t)),t.hideDrawer=t.hideDrawer.bind(Object(c.a)(t)),t.setActiveRoute=t.setActiveRoute.bind(Object(c.a)(t)),t.addRouteEvent=t.addRouteEvent.bind(Object(c.a)(t)),t.enterChannel=t.enterChannel.bind(Object(c.a)(t)),t.leaveChannel=t.leaveChannel.bind(Object(c.a)(t)),t.toggleSettingsSend=t.toggleSettingsSend.bind(Object(c.a)(t)),t.toggleSettingsNotifications=t.toggleSettingsNotifications.bind(Object(c.a)(t)),t.toggleSettingsSounds=t.toggleSettingsSounds.bind(Object(c.a)(t));try{t.beep=new Audio("/beep.wav")}catch(s){console.log(s)}return t}return Object(o.a)(u,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.theme!==e.theme||this.state.drawerVisible!==t.drawerVisible||this.state.activeRoute!==t.activeRoute||Object.entries(this.state.routeEvents).sort().toString()!==Object.entries(t.routeEvents).sort().toString()||this.state.channels.toString()!==t.channels.toString()||Object.entries(this.state.settings).sort().toString()!==Object.entries(t.settings).sort().toString()}},{key:"componentDidMount",value:function(){g.a.pageview(window.location.pathname+window.location.search),window.visualViewport&&requestAnimationFrame&&window.visualViewport.addEventListener("resize",this.viewportResize),this.setState((function(e){return{settings:{send:localStorage.getItem("settings-send")?!!parseInt(localStorage.getItem("settings-send")):e.settings.send,notifications:localStorage.getItem("settings-notifications")?!!parseInt(localStorage.getItem("settings-notifications")):e.settings.notifications,sounds:localStorage.getItem("settings-sounds")?!!parseInt(localStorage.getItem("settings-sounds")):e.settings.sounds}}}))}},{key:"componentWillUnmount",value:function(){window.visualViewport&&requestAnimationFrame&&window.visualViewport.removeEventListener("resize",this.viewportResize)}},{key:"viewportResize",value:function(e){var t=this;this.viewportResizeUpdate||(this.viewportResizeUpdate=!0,requestAnimationFrame((function(){try{t.rootRef.current.style.bottom="auto",t.rootRef.current.style.height=e.target.height+"px",t.rootRef.current.scrollIntoView();var n=t.state.channels.map((function(e){return e.route})).indexOf(t.state.activeRoute);n>-1&&t.state.channels[n].ref.current.channelListRef.current.scrollDown()}catch(s){console.log(s)}t.viewportResizeUpdate=!1})))}},{key:"showDrawer",value:function(){this.setState({drawerVisible:!0})}},{key:"hideDrawer",value:function(){this.setState({drawerVisible:!1})}},{key:"setActiveRoute",value:function(e){this.setState((function(t){return{drawerVisible:!1,activeRoute:e,routeEvents:Object(i.a)(Object(i.a)({},t.routeEvents),{},Object(a.a)({},e,0))}}))}},{key:"addRouteEvent",value:function(e){var t=this;if(this.state.settings.notifications){var n=this.state.channels.map((function(e){return e.route})).indexOf(e);if(n>-1)try{Notification.requestPermission((function(s){"granted"===s&&navigator.serviceWorker.ready.then((function(s){s.showNotification("ChatCrypt",{body:"New message at #"+t.state.channels[n].channel,icon:"/logo512.png",tag:"chatcrypt-"+e,renotify:!0})}))}))}catch(s){console.log(s)}}if(this.state.settings.sounds)try{this.beep.play()}catch(s){console.log(s)}e!==this.state.activeRoute&&this.setState((function(t){return{routeEvents:Object(i.a)(Object(i.a)({},t.routeEvents),{},Object(a.a)({},e,t.routeEvents[e]?t.routeEvents[e]+1:1))}}))}},{key:"enterChannel",value:function(t,n,a){var i="channel-"+e.from(n,"utf8").toString("hex");return!(this.state.channels.map((function(e){return e.route})).indexOf(i)>-1)&&(this.setState((function(e){return{activeRoute:i,channels:[].concat(Object(s.a)(e.channels),[{ref:p.a.createRef(),route:i,channel:n,username:t,password:a}])}})),!0)}},{key:"leaveChannel",value:function(e){this.state.channels.map((function(e){return e.route})).indexOf(e)>-1&&this.setState((function(t){return{activeRoute:"enter",channels:t.channels.filter((function(t){return t.route!==e}))}}))}},{key:"toggleSettingsSend",value:function(){this.setState((function(e){return localStorage.setItem("settings-send",e.settings.send?0:1),{settings:Object(i.a)(Object(i.a)({},e.settings),{},{send:!e.settings.send})}}))}},{key:"toggleSettingsNotifications",value:function(){this.setState((function(e){return localStorage.setItem("settings-notifications",e.settings.notifications?0:1),{settings:Object(i.a)(Object(i.a)({},e.settings),{},{notifications:!e.settings.notifications})}}))}},{key:"toggleSettingsSounds",value:function(){this.setState((function(e){return localStorage.setItem("settings-sounds",e.settings.sounds?0:1),{settings:Object(i.a)(Object(i.a)({},e.settings),{},{sounds:!e.settings.sounds})}}))}},{key:"render",value:function(){var e=this;return p.a.createElement("div",{ref:this.rootRef,className:this.props.classes.root},p.a.createElement(v.a,{theme:this.props.theme,showDrawer:this.showDrawer,activeRoute:this.state.activeRoute,routeEvent:Object.values(this.state.routeEvents).reduce((function(e,t){return e+t}),0)>0?1:0,channel:this.state.activeRoute.match(/^channel/)?this.state.channels[this.state.channels.map((function(e){return e.route})).indexOf(this.state.activeRoute)]:null,leaveChannel:this.leaveChannel}),p.a.createElement(f.a,{theme:this.props.theme,drawerVisible:this.state.drawerVisible,showDrawer:this.showDrawer,hideDrawer:this.hideDrawer,activeRoute:this.state.activeRoute,setActiveRoute:this.setActiveRoute,routeEvents:this.state.routeEvents,channels:this.state.channels}),p.a.createElement("main",{className:this.props.classes.main},p.a.createElement(m.a,null),p.a.createElement(b.a,{visible:"enter"===this.state.activeRoute,theme:this.props.theme,channels:this.state.channels.map((function(e){return e.channel})),enterChannel:this.enterChannel}),this.state.channels.map((function(t){return p.a.createElement(y.a,{ref:t.ref,visible:e.state.activeRoute===t.route,theme:e.props.theme,key:t.route,channel:t,addRouteEvent:e.addRouteEvent,settingsSend:e.state.settings.send})})),p.a.createElement(E.a,{visible:"settings"===this.state.activeRoute,theme:this.props.theme,setTheme:this.props.setTheme,settings:this.state.settings,toggleSettingsSend:this.toggleSettingsSend,toggleSettingsNotifications:this.toggleSettingsNotifications,toggleSettingsSounds:this.toggleSettingsSounds})))}}]),u}(p.a.Component);t.a=Object(d.a)((function(e){return{root:{top:"0px",left:"0px",right:"0px",bottom:"0px",height:"auto",display:"flex",position:"absolute",flexDirection:"row"},main:{display:"flex",flexGrow:1,alignItems:"stretch",flexDirection:"column"}}}))(S)}).call(this,n(97).Buffer)},108:function(e,t,n){"use strict";var s=n(11),a=n(12),i=n(7),r=n(14),o=n(13),c=n(22),l=n(0),h=n.n(l),u=n(5),p=n(173),d=n(121),m=n(88),g=n(174),v=n(40),f=n(175),b=n(176),y=n(177),E=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).leaveChannel=a.leaveChannel.bind(Object(i.a)(a)),a.showClients=a.showClients.bind(Object(i.a)(a)),a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.theme!==e.theme||this.props.activeRoute!==e.activeRoute||this.props.routeEvent!==e.routeEvent}},{key:"leaveChannel",value:function(){this.props.channel&&this.props.leaveChannel(this.props.channel.route)}},{key:"showClients",value:function(){if(this.props.channel)try{this.props.channel.ref.current.showClients()}catch(e){console.log(e)}}},{key:"render",value:function(){return h.a.createElement(p.a,{position:"fixed",className:this.props.classes.root},h.a.createElement(d.a,null,h.a.createElement(m.a,{edge:"start",color:"inherit",className:this.props.classes.menu,"aria-label":"Open drawer",onClick:this.props.showDrawer},h.a.createElement(g.a,{badgeContent:this.props.routeEvent,variant:"dot",color:"secondary"},h.a.createElement(f.a,null))),h.a.createElement(v.a,{variant:"h6",noWrap:!0,className:this.props.classes.title},this.props.channel?"#"+this.props.channel.channel:"enter"===this.props.activeRoute?"Enter a channel":"Settings"),this.props.channel&&h.a.createElement(h.a.Fragment,null,h.a.createElement(m.a,{color:"inherit","aria-label":"Leave channel",onClick:this.leaveChannel},h.a.createElement(b.a,null)),h.a.createElement(m.a,{edge:"end",color:"inherit","aria-label":"Show members",onClick:this.showClients},h.a.createElement(y.a,null)))))}}]),n}(h.a.Component);t.a=Object(u.a)((function(e){return{root:Object(c.a)({},e.breakpoints.up("md"),{width:"calc(100% - ".concat(240,"px)"),marginLeft:"240px"}),menu:Object(c.a)({marginRight:e.spacing(1)},e.breakpoints.up("md"),{display:"none"}),title:{flexGrow:1}}}))(E)},113:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var s=n(34),a=n(57),i=n(35),r=n.n(i),o=n(58),c=n(11),l=n(12),h=n(144).sha256,u=n(147).ec,p=n(169),d=n(170),m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(c.a)(this,t),this.config={rsaPublic:e.rsaPublic||"",wsAddress:e.wsAddress||"",reconnectDelay:e.reconnectDelay||3e3,pingInterval:e.pingInterval||2e4,debug:e.debug||!1},this.callbacks={onServerClosed:n.onServerClosed||null,onServerSecured:n.onServerSecured||null,onClientSecured:n.onClientSecured||null,onClientList:n.onClientList||null,onClientMessage:n.onClientMessage||null};try{this.clientEc=new u("curve25519")}catch(s){this.logEvent("constructor",s,"error")}this.serverKeys=null,this.serverShared=null,this.credentials=null,this.connection=null,this.reconnect=null,this.ping=null,this.channel={},this.setCredentials=this.setCredentials.bind(this),this.connect=this.connect.bind(this),this.destruct=this.destruct.bind(this),this.onOpen=this.onOpen.bind(this),this.onMessage=this.onMessage.bind(this),this.onError=this.onError.bind(this),this.onClose=this.onClose.bind(this),this.logEvent=this.logEvent.bind(this),this.isOpen=this.isOpen.bind(this),this.isClosed=this.isClosed.bind(this),this.startReconnect=this.startReconnect.bind(this),this.stopReconnect=this.stopReconnect.bind(this),this.startPing=this.startPing.bind(this),this.stopPing=this.stopPing.bind(this),this.disconnect=this.disconnect.bind(this),this.sendMessage=this.sendMessage.bind(this),this.sendChannelMessage=this.sendChannelMessage.bind(this),this.encryptServerMessage=this.encryptServerMessage.bind(this),this.decryptServerMessage=this.decryptServerMessage.bind(this),this.encryptClientMessage=this.encryptClientMessage.bind(this),this.decryptClientMessage=this.decryptClientMessage.bind(this)}return Object(l.a)(t,[{key:"setCredentials",value:function(e,t,n){this.logEvent("setCredentials");try{this.credentials={username:e,channel:h(t),password:h(n)}}catch(s){return this.logEvent("setCredentials",s,"error"),!1}return!0}},{key:"connect",value:function(){if(!this.credentials)return!1;this.logEvent("connect",this.config.wsAddress),this.stopReconnect(),this.stopPing(),this.serverKeys=null,this.serverShared=null,this.channel={};try{this.connection=new WebSocket(this.config.wsAddress),this.connection.onopen=this.onOpen,this.connection.onmessage=this.onMessage,this.connection.onerror=this.onError,this.connection.onclose=this.onClose}catch(e){return this.logEvent("connect",e,"error"),!1}return!0}},{key:"destruct",value:function(){this.logEvent("destruct"),this.stopReconnect(),this.stopPing(),this.reconnect=null,this.ping=null,this.config={rsaPublic:"",wsAddress:"",reconnectDelay:3e3,pingInterval:15e3,debug:!1},this.callbacks.onServerClosed=null,this.callbacks.onServerSecured=null,this.callbacks.onClientSecured=null,this.callbacks.onClientList=null,this.callbacks.onClientMessage=null,this.clientEc=null,this.serverKeys=null,this.serverShared=null,this.credentials=null,this.connection.onopen=null,this.connection.onmessage=null,this.connection.onerror=null,this.connection.onclose=null;try{this.connection.removeAllListeners()}catch(e){this.logEvent("destruct",e,"error")}try{this.connection.close()}catch(e){this.logEvent("destruct",e,"error")}return this.connection=null,this.channel={},!0}},{key:"onOpen",value:function(){var t=Object(o.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.logEvent("onOpen"),this.startPing(),t.prev=2,t.next=5,crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-384"},!1,["deriveKey","deriveBits"]);case 5:return this.serverKeys=t.sent,this.serverShared=null,t.t0=this,t.t1=e,t.next=11,crypto.subtle.exportKey("raw",this.serverKeys.publicKey);case 11:t.t2=t.sent,t.t3=t.t1.from.call(t.t1,t.t2).toString("hex"),t.t0.sendMessage.call(t.t0,t.t3),t.next=19;break;case 16:t.prev=16,t.t4=t.catch(2),this.logEvent("onOpen",t.t4,"error");case 19:case"end":return t.stop()}}),t,this,[[2,16]])})));return function(){return t.apply(this,arguments)}}()},{key:"onMessage",value:function(){var t=Object(o.a)(r.a.mark((function t(n){var s,i,o,c,l,h,u,p,d,m;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n&&this.isString(n.data)){t.next=2;break}return t.abrupt("return");case 2:if("pong"!==n.data){t.next=4;break}return t.abrupt("return");case 4:if(this.logEvent("onMessage",n.data),this.serverShared){t.next=40;break}if((s=n.data.split("|"))[0]&&s[1]){t.next=9;break}return t.abrupt("return");case 9:return t.prev=9,t.t0=crypto.subtle,t.t1={name:"RSASSA-PKCS1-v1_5"},t.next=14,crypto.subtle.importKey("spki",e.from(this.config.rsaPublic,"base64"),{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);case 14:return t.t2=t.sent,t.t3=e.from(s[1],"base64"),t.t4=e.from(s[0],"hex"),t.next=19,t.t0.verify.call(t.t0,t.t1,t.t2,t.t3,t.t4);case 19:if(t.t5=t.sent,!0!==t.t5){t.next=34;break}return t.t6=e,t.t7=crypto.subtle,t.next=25,crypto.subtle.importKey("raw",e.from(s[0],"hex"),{name:"ECDH",namedCurve:"P-384"},!0,[]);case 25:return t.t8=t.sent,t.t9={name:"ECDH",namedCurve:"P-384",public:t.t8},t.t10=this.serverKeys.privateKey,t.next=30,t.t7.deriveBits.call(t.t7,t.t9,t.t10,384);case 30:if(t.t11=t.sent,this.serverShared=t.t6.from.call(t.t6,t.t11).slice(8,40),this.sendMessage(this.encryptServerMessage({a:"j",p:this.credentials.channel},this.serverShared)),this.callbacks.onServerSecured)try{this.callbacks.onServerSecured()}catch(r){this.logEvent("onMessage-server-secured-callback",r,"error")}case 34:t.next=39;break;case 36:t.prev=36,t.t12=t.catch(9),this.logEvent("onMessage",t.t12,"error");case 39:return t.abrupt("return");case 40:if(i=this.decryptServerMessage(n.data,this.serverShared),this.logEvent("onMessage-server-decrypted",i),this.isObject(i)&&this.isString(i.a)){t.next=44;break}return t.abrupt("return");case 44:if("l"!==i.a||!this.isArray(i.p)){t.next=48;break}try{for(o in this.channel)i.p.indexOf(o)<0&&delete this.channel[o];c={},l=Object(a.a)(i.p);try{for(l.s();!(h=l.n()).done;)u=h.value,this.channel[u]||(this.channel[u]={username:null,keys:this.clientEc.genKeyPair(),shared:null},c[u]=this.channel[u].keys.getPublic("hex"))}catch(g){l.e(g)}finally{l.f()}Object.keys(c).length>0&&this.sendMessage(this.encryptServerMessage({a:"w",p:c},this.serverShared))}catch(r){this.logEvent("onMessage-list",r,"error")}if(this.callbacks.onClientList){for(d in p=[],this.channel)this.channel[d].shared&&this.channel[d].username&&p.push({clientId:d,username:this.channel[d].username});try{this.callbacks.onClientList(p)}catch(r){this.logEvent("onMessage-client-list-callback",r,"error")}}return t.abrupt("return");case 48:if(this.isString(i.p)&&this.isString(i.c)){t.next=50;break}return t.abrupt("return");case 50:if("c"!==i.a||this.channel[i.c]&&this.channel[i.c].shared){t.next=53;break}try{this.channel[i.c]||(this.channel[i.c]={username:null,keys:this.clientEc.genKeyPair(),shared:null},this.sendMessage(this.encryptServerMessage({a:"c",p:this.channel[i.c].keys.getPublic("hex"),c:i.c},this.serverShared))),this.channel[i.c].shared=e.from(this.xorHex(this.channel[i.c].keys.derive(this.clientEc.keyFromPublic(i.p,"hex").getPublic()).toString("hex").padEnd(64,"8").substr(0,64),this.credentials.password),"hex"),this.sendMessage(this.encryptServerMessage({a:"c",p:this.encryptClientMessage({a:"u",p:this.credentials.username},this.channel[i.c].shared),c:i.c},this.serverShared))}catch(r){this.logEvent("onMessage-client",r,"error")}return t.abrupt("return");case 53:if("c"!==i.a||!this.channel[i.c]||!this.channel[i.c].shared){t.next=67;break}if(m=this.decryptClientMessage(i.p,this.channel[i.c].shared),this.logEvent("onMessage-client-decrypted",m),this.isObject(m)&&this.isString(m.a)){t.next=58;break}return t.abrupt("return");case 58:if("u"!==m.a||!this.isString(m.p)||!m.p.match(/\S+/)||this.channel[i.c].username){t.next=62;break}if(this.channel[i.c].username=m.p.replace(/^\s+/,"").replace(/\s+$/,""),this.callbacks.onClientSecured)try{this.callbacks.onClientSecured({clientId:i.c,username:this.channel[i.c].username})}catch(r){this.logEvent("onMessage-client-secured-callback",r,"error")}return t.abrupt("return");case 62:if(this.channel[i.c].username){t.next=64;break}return t.abrupt("return");case 64:if("m"!==m.a||!this.isString(m.t)||!this.isString(m.d)){t.next=67;break}if(this.callbacks.onClientMessage)try{this.callbacks.onClientMessage({clientId:i.c,username:this.channel[i.c].username,type:m.t,data:m.d})}catch(r){this.logEvent("onMessage-client-message-callback",r,"error")}return t.abrupt("return");case 67:case"end":return t.stop()}}),t,this,[[9,36]])})));return function(e){return t.apply(this,arguments)}}()},{key:"onError",value:function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logEvent("onError",t,"error"),this.disconnect(),this.credentials&&this.startReconnect(),this.callbacks.onServerClosed)try{this.callbacks.onServerClosed()}catch(n){this.logEvent("onError-server-closed-callback",n,"error")}case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onClose",value:function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logEvent("onClose",t),this.disconnect(),this.credentials&&this.startReconnect(),this.callbacks.onServerClosed)try{this.callbacks.onServerClosed()}catch(n){this.logEvent("onClose-server-closed-callback",n,"error")}case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"logEvent",value:function(e,t,n){if(this.config.debug){var s=new Date,a=s.getFullYear()+"-"+("0"+(s.getMonth()+1)).slice(-2)+"-"+("0"+s.getDate()).slice(-2)+" "+("0"+s.getHours()).slice(-2)+":"+("0"+s.getMinutes()).slice(-2)+":"+("0"+s.getSeconds()).slice(-2);console.log("["+a+"]",n?n.toUpperCase():"INFO",e+(t?":":""),t||"")}}},{key:"isOpen",value:function(){return!(!this.connection||!this.connection.readyState||this.connection.readyState!==WebSocket.OPEN)}},{key:"isClosed",value:function(){return!this.connection||!this.connection.readyState||this.connection.readyState===WebSocket.CLOSED}},{key:"startReconnect",value:function(){var e=this;this.stopReconnect(),this.logEvent("startReconnect"),this.reconnect=setTimeout((function(){e.reconnect=null,e.connect()}),this.config.reconnectDelay)}},{key:"stopReconnect",value:function(){this.reconnect&&(this.logEvent("stopReconnect"),clearTimeout(this.reconnect),this.reconnect=null)}},{key:"startPing",value:function(){var e=this;this.stopPing(),this.logEvent("startPing"),this.ping=setInterval((function(){e.sendMessage("ping")}),this.config.pingInterval)}},{key:"stopPing",value:function(){this.ping&&(this.logEvent("stopPing"),clearInterval(this.ping),this.ping=null)}},{key:"disconnect",value:function(){if(this.stopReconnect(),this.stopPing(),!this.isClosed())try{this.logEvent("disconnect"),this.connection.close()}catch(e){this.logEvent("disconnect",e,"error")}}},{key:"sendMessage",value:function(e){try{if(this.isOpen())return this.connection.send(e),!0}catch(t){this.logEvent("sendMessage",t,"error")}return!1}},{key:"sendChannelMessage",value:function(e,t){if(this.serverShared)try{var n={};for(var s in this.channel)if(this.channel[s].shared&&this.channel[s].username&&(n[s]=this.encryptClientMessage({a:"m",t:e,d:t},this.channel[s].shared),0===n[s].length))return!1;if(Object.keys(n).length>0){var a=this.encryptServerMessage({a:"w",p:n},this.serverShared);if(!this.isOpen()||0===a.length||a.length>8388608)return!1;this.connection.send(a)}return!0}catch(i){this.logEvent("sendChannelMessage",i,"error")}return!1}},{key:"encryptServerMessage",value:function(t,n){var a="";try{(t=e.from(JSON.stringify(t),"utf8")).length%16!==0&&(t=e.from([].concat(Object(s.a)(t),Object(s.a)(e.alloc(16-t.length%16)))));var i=e.from(crypto.getRandomValues(new Uint8Array(16))),r=new p.ModeOfOperation.cbc(n,i);a=i.toString("base64")+"|"+e.from(r.encrypt(t)).toString("base64")}catch(o){this.logEvent("encryptServerMessage",o,"error")}return a}},{key:"decryptServerMessage",value:function(t,n){var s={};try{var a=t.split("|"),i=new p.ModeOfOperation.cbc(n,e.from(a[0],"base64"));s=JSON.parse(e.from(i.decrypt(e.from(a[1],"base64"))).toString("utf8").replace(/\0+$/,""))}catch(r){this.logEvent("decryptServerMessage",r,"error")}return s}},{key:"encryptClientMessage",value:function(t,n){var a="";try{(t=e.from(JSON.stringify(t),"utf8")).length%16!==0&&(t=e.from([].concat(Object(s.a)(t),Object(s.a)(e.alloc(16-t.length%16)))));var i=e.from(crypto.getRandomValues(new Uint8Array(12))),r=e.from(crypto.getRandomValues(new Uint8Array(4))),o=new d(n,i,r.reduce((function(e,t){return e*t})));a=i.toString("base64")+"|"+r.toString("base64")+"|"+e.from(o.encrypt(t)).toString("base64")}catch(c){this.logEvent("encryptClientMessage",c,"error")}return a}},{key:"decryptClientMessage",value:function(t,n){var s={};try{var a=t.split("|"),i=new d(n,e.from(a[0],"base64"),e.from(a[1],"base64").reduce((function(e,t){return e*t})));s=JSON.parse(e.from(i.decrypt(e.from(a[2],"base64"))).toString("utf8").replace(/\0+$/,""))}catch(r){this.logEvent("decryptClientMessage",r,"error")}return s}},{key:"xorHex",value:function(e,t){for(var n="",s=Math.min(e.length,t.length),a=0;a<s;++a)n+=(parseInt(e.charAt(a),16)^parseInt(t.charAt(a),16)).toString(16);return n}},{key:"isString",value:function(e){return!(!e||"[object String]"!==Object.prototype.toString.call(e))}},{key:"isArray",value:function(e){return!(!e||"[object Array]"!==Object.prototype.toString.call(e))}},{key:"isObject",value:function(e){return!(!e||"[object Object]"!==Object.prototype.toString.call(e))}}]),t}()}).call(this,n(97).Buffer)},114:function(e,t,n){"use strict";var s=n(11),a=n(12),i=n(7),r=n(14),o=n(13),c=n(0),l=n.n(c),h=n(5),u=n(180),p=n(76),d=n(178),m=n(78),g=n(79),v=n(80),f=n(81),b=n(82),y=n(40),E=n(181),S=n(182),w=n(183),C=n(184),k=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).toggleTheme=a.toggleTheme.bind(Object(i.a)(a)),a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.visible!==e.visible||this.props.theme!==e.theme||Object.entries(this.props.settings).sort().toString()!==Object.entries(e.settings).sort().toString()}},{key:"componentDidUpdate",value:function(e){if(this.props.settings.notifications&&!e.settings.notifications)try{Notification.requestPermission()}catch(t){console.log(t)}}},{key:"toggleTheme",value:function(){this.props.setTheme("light"===this.props.theme?"dark":"light")}},{key:"render",value:function(){return l.a.createElement("div",{className:this.props.classes.root,style:{display:this.props.visible?"flex":"none"}},l.a.createElement(u.a,{disableGutters:!0,maxWidth:"sm"},l.a.createElement(p.a,{className:this.props.classes.paper,elevation:1},l.a.createElement(d.a,null,l.a.createElement(m.a,{key:"dark"},l.a.createElement(g.a,null,l.a.createElement(E.a,null)),l.a.createElement(v.a,{id:"settings-dark",primary:"Dark mode"}),l.a.createElement(f.a,null,l.a.createElement(b.a,{edge:"end",onChange:this.toggleTheme,checked:"dark"===this.props.theme,inputProps:{"aria-labelledby":"settings-dark"}}))),l.a.createElement(m.a,{key:"send"},l.a.createElement(g.a,null,l.a.createElement(S.a,null)),l.a.createElement(v.a,{id:"settings-send",primary:"Enter is send"}),l.a.createElement(f.a,null,l.a.createElement(b.a,{edge:"end",onChange:this.props.toggleSettingsSend,checked:this.props.settings.send,inputProps:{"aria-labelledby":"settings-send"}}))),l.a.createElement(m.a,{key:"notifications"},l.a.createElement(g.a,null,l.a.createElement(w.a,null)),l.a.createElement(v.a,{id:"settings-notifications",primary:"Notifications"}),l.a.createElement(f.a,null,l.a.createElement(b.a,{edge:"end",onChange:this.props.toggleSettingsNotifications,checked:this.props.settings.notifications,inputProps:{"aria-labelledby":"settings-notifications"}}))),l.a.createElement(m.a,{key:"sounds"},l.a.createElement(g.a,null,l.a.createElement(C.a,null)),l.a.createElement(v.a,{id:"settings-sounds",primary:"Sounds"}),l.a.createElement(f.a,null,l.a.createElement(b.a,{edge:"end",onChange:this.props.toggleSettingsSounds,checked:this.props.settings.sounds,inputProps:{"aria-labelledby":"settings-sounds"}}))))),l.a.createElement("div",null,l.a.createElement(y.a,{className:this.props.classes.text,variant:"body2",color:"secondary"},"Notifications and sounds are currently in an experimental stage, they probably won't work on outdated or Apple (iOS/macOS/Safari/etc) systems."))))}}]),n}(l.a.Component);t.a=Object(h.a)((function(e){return{root:{height:"100%",overflow:"auto",paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},paper:{marginTop:e.spacing(2),marginBottom:e.spacing(3)},text:{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),paddingBottom:e.spacing(2)}}}))(k)},116:function(e,t,n){"use strict";var s=n(34),a=n(57),i=n(11),r=n(12),o=n(7),c=n(14),l=n(13),h=n(0),u=n.n(h),p=n(5),d=n(112),m=n(78),g=n(80),v=n(40),f=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.index!==e.index||this.props.first!==e.first||this.props.last!==e.last}},{key:"render",value:function(){var e={wordBreak:"break-word",whiteSpace:"pre-line",paddingTop:"0px",paddingBottom:"0px"};return this.props.first&&delete e.paddingTop,this.props.last&&delete e.paddingBottom,u.a.createElement(m.a,{style:e},"text"===this.props.item.type?u.a.createElement(g.a,{className:this.props.classes.text,primary:u.a.createElement(u.a.Fragment,null,u.a.createElement(v.a,{component:"span",variant:"body2",className:this.props.classes.inline,color:"primary"},"@",this.props.item.username),u.a.createElement(v.a,{component:"span",variant:"caption",className:this.props.classes.inline,color:"textSecondary"}," "+this.props.item.note)),secondary:u.a.createElement(v.a,{component:"span",variant:"body1",className:this.props.classes.inline,color:"textPrimary"},this.props.item.data)}):u.a.createElement(g.a,{primary:u.a.createElement(u.a.Fragment,null,u.a.createElement(v.a,{component:"span",variant:"body2",className:this.props.classes.inline,color:"primary"},this.props.item.data),u.a.createElement(v.a,{component:"span",variant:"caption",className:this.props.classes.inline,color:"textSecondary"}," "+this.props.item.note))}))}}]),n}(u.a.Component),b=Object(p.a)((function(e){return{text:{marginTop:e.spacing(.33),marginBottom:e.spacing(.33)},inline:{display:"inline",userSelect:"text"}}}))(f),y=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var s;return Object(i.a)(this,n),(s=t.call(this,e)).listRef=u.a.createRef(),s.scrollDownTimeout=null,s.scrollDown=s.scrollDown.bind(Object(o.a)(s)),s.generateItem=s.generateItem.bind(Object(o.a)(s)),s}return Object(r.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.theme!==e.theme||this.props.messageListUpdated!==e.messageListUpdated}},{key:"componentDidUpdate",value:function(){this.scrollDown()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.scrollDownTimeout)}},{key:"scrollDown",value:function(){var e=this;clearTimeout(this.scrollDownTimeout),this.scrollDownTimeout=setTimeout((function(){try{e.listRef.current.scrollToIndex({index:e.props.messageList.length-1,align:"end"})}catch(t){console.log(t)}}),50)}},{key:"generateItem",value:function(e){return u.a.createElement(b,{index:e,first:0===e,last:e===this.props.messageList.length-1,item:this.props.messageList[e]})}},{key:"render",value:function(){return u.a.createElement("div",{className:this.props.classes.root},u.a.createElement(d.a,{ref:this.listRef,totalCount:this.props.messageList.length,overscan:200,item:this.generateItem,style:{width:"100%",height:"100%"}}))}}]),n}(u.a.Component),E=Object(p.a)((function(e){return{root:{width:"100%",height:"100%",display:"flex"}}}))(y),S=n(22),w=n(231),C=n(222),k=n(223),O=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var s;return Object(i.a)(this,n),(s=t.call(this,e)).state={text:""},s.inputRef=u.a.createRef(),s.updateText=s.updateText.bind(Object(o.a)(s)),s.sendTextMessage=s.sendTextMessage.bind(Object(o.a)(s)),s.handleKeyDown=s.handleKeyDown.bind(Object(o.a)(s)),s}return Object(r.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.theme!==e.theme||this.props.secured!==e.secured||this.state.text!==t.text||this.props.settingsSend!==e.settingsSend}},{key:"updateText",value:function(e){this.setState({text:e.target.value})}},{key:"handleKeyDown",value:function(e){this.props.settingsSend&&13===e.keyCode&&!e.shiftKey&&(e.preventDefault(),this.sendTextMessage())}},{key:"sendTextMessage",value:function(){if(this.state.text.length>0&&this.props.secured){try{this.inputRef.current.focus()}catch(e){console.log(e)}this.props.sendTextMessage(this.state.text),this.setState({text:""})}}},{key:"render",value:function(){return u.a.createElement("div",{className:this.props.classes.root},u.a.createElement(w.a,{className:this.props.classes.input,id:"message",inputRef:this.inputRef,fullWidth:!0,variant:"outlined",multiline:!0,rows:3,label:"Message",inputProps:{autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"},disabled:!this.props.secured,value:this.state.text,onChange:this.updateText,onKeyDown:this.handleKeyDown}),u.a.createElement(C.a,{className:this.props.classes.button,size:"large",variant:"contained",color:"primary",disableElevation:!0,disabled:!(this.state.text.length>0&&this.props.secured),startIcon:u.a.createElement(k.a,null),"aria-label":"Send",onClick:this.sendTextMessage}))}}]),n}(u.a.Component),j=Object(p.a)((function(e){return{root:{display:"flex",flexDirection:"row"},input:Object(S.a)({},"& fieldset",{borderRadius:"0px"}),button:{borderRadius:"0px"}}}))(O),x=n(179),R=n(234),M=n(232),L=n(224),U=function(e){return u.a.createElement(x.a,Object.assign({},e,{direction:"up"}))},D=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.theme!==e.theme||this.props.secured!==e.secured}},{key:"render",value:function(){return u.a.createElement(R.a,{open:!this.props.secured,anchorOrigin:{vertical:"bottom",horizontal:"center"},TransitionComponent:U},u.a.createElement(M.a,{severity:"info",icon:u.a.createElement(L.a,{fontSize:"inherit"})},"Establishing secure connection..."))}}]),n}(u.a.Component),N=Object(p.a)((function(e){return{}}))(D),A=n(225),T=n(226),P=n(227),I=n(228),K=n(178),V=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.theme!==e.theme||this.props.clientListUpdated!==e.clientListUpdated}},{key:"render",value:function(){return u.a.createElement(K.a,{dense:!0},this.props.clientList.map((function(e){return u.a.createElement(m.a,{key:e.clientId,style:{wordBreak:"break-word"}},u.a.createElement(g.a,{primary:"@"+e.username}))})))}}]),n}(u.a.Component),W=Object(p.a)((function(e){return{}}))(V),B=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var s;return Object(i.a)(this,n),(s=t.call(this,e)).hideClients=s.hideClients.bind(Object(o.a)(s)),s}return Object(r.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.theme!==e.theme||this.props.clientsVisible!==e.clientsVisible||this.props.clientListUpdated!==e.clientListUpdated}},{key:"hideClients",value:function(){this.props.hideClients()}},{key:"render",value:function(){return u.a.createElement(A.a,{classes:{paper:this.props.classes.paper},open:this.props.clientsVisible,maxWidth:"xs",onClose:this.hideClients},u.a.createElement(T.a,null,"Members"),u.a.createElement(P.a,{dividers:!0},u.a.createElement(W,{theme:this.props.theme,clientList:this.props.clientList,clientListUpdated:this.props.clientListUpdated})),u.a.createElement(I.a,null,u.a.createElement(C.a,{autoFocus:!0,color:"primary",onClick:this.hideClients},"Close")))}}]),n}(u.a.Component),z=Object(p.a)((function(e){return{paper:{width:"80%",maxHeight:"435px"}}}))(B),H=n(113),F=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var s;return Object(i.a)(this,n),(s=t.call(this,e)).state={secured:!1,messageListUpdated:0,clientListUpdated:0,clientsVisible:!1},s.debug=!1,s.mounted=!1,s.chat=null,s.messageList=[],s.clientList=[],s.channelListRef=u.a.createRef(),s.showClients=s.showClients.bind(Object(o.a)(s)),s.hideClients=s.hideClients.bind(Object(o.a)(s)),s.sendTextMessage=s.sendTextMessage.bind(Object(o.a)(s)),s.messageDate=s.messageDate.bind(Object(o.a)(s)),s.onServerClosed=s.onServerClosed.bind(Object(o.a)(s)),s.onServerSecured=s.onServerSecured.bind(Object(o.a)(s)),s.onClientSecured=s.onClientSecured.bind(Object(o.a)(s)),s.onClientList=s.onClientList.bind(Object(o.a)(s)),s.onClientMessage=s.onClientMessage.bind(Object(o.a)(s)),s}return Object(r.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.visible!==e.visible||this.props.theme!==e.theme||this.state.secured!==t.secured||this.state.messageListUpdated!==t.messageListUpdated||this.state.clientListUpdated!==t.clientListUpdated||this.state.clientsVisible!==t.clientsVisible||this.props.settingsSend!==e.settingsSend}},{key:"componentDidMount",value:function(){this.mounted=!0;try{this.chat=new H.a({rsaPublic:"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqH4tpxdB9Racf1tbssYU9KeiyMjPRnaZAJH+LEb+1RfRoiC+7HCSex6iHviCnpZWjKJbePm5WubCvdLu7L7AxFevN1xCq6Y6XfAb3HodapaZM+omcVQWw/bhhfNDGNGXK8eEUUgqoh1i0EJqgx9GrwIz/zYBGc9BvOYfd1LtrfOcXnibWSL91Y7mbkVtW9EiGoGaYwYQclCod4vYOsCdYIVYnVZP8MrRmE0FGhc/XjBdq8Vk2pXDLBFH7faGF0Hn6TgTiapJQ99KX3LnujBkjE1jmETgnMUT2C0R33UUfGxQ8U1rYolNW57L5CeoHf/7JKa5JtadaprO6pf5ruodlQIDAQAB",wsAddress:"wss://client.chatcrypt.com/server/",debug:this.debug},{onServerClosed:this.onServerClosed,onServerSecured:this.onServerSecured,onClientSecured:this.onClientSecured,onClientList:this.onClientList,onClientMessage:this.onClientMessage}),this.chat.setCredentials(this.props.channel.username,this.props.channel.channel,this.props.channel.password),this.chat.connect()}catch(e){this.debug&&console.log("componentDidMount",e)}}},{key:"componentWillUnmount",value:function(){this.mounted=!1,this.messageList=[],this.clientList=[];try{this.chat.destruct()}catch(e){this.debug&&console.log("componentWillUnmount",e)}this.chat=null}},{key:"sendTextMessage",value:function(e){if(this.mounted){var t=!1;try{t=this.chat.sendChannelMessage("t",e)}catch(n){this.debug&&console.log("sendTextMessage",n)}this.mounted&&(this.messageList.push({username:this.props.channel.username,data:e,type:"text",note:t?this.messageDate():"Failed"}),this.setState((function(e){return{messageListUpdated:e.messageListUpdated+1}})))}}},{key:"messageDate",value:function(){var e=new Date;return("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)}},{key:"onServerClosed",value:function(){var e=this;this.mounted&&this.setState((function(t){if(!1===t.secured)return{};var n,s=Object(a.a)(e.clientList);try{for(s.s();!(n=s.n()).done;){var i=n.value;e.messageList.push({data:"Secured a connection with @"+i.username,type:"notice",note:e.messageDate()})}}catch(r){s.e(r)}finally{s.f()}return e.messageList.push({data:"Server connection closed",type:"notice",note:e.messageDate()}),e.clientList=[],{secured:!1,messageListUpdated:t.messageListUpdated+1,clientListUpdated:t.clientListUpdated+1}}))}},{key:"onServerSecured",value:function(){this.mounted&&(this.messageList.push({data:"Server connection secured",type:"notice",note:this.messageDate()}),this.setState((function(e){return{secured:!0,messageListUpdated:e.messageListUpdated+1}})))}},{key:"onClientSecured",value:function(e){this.mounted&&(this.messageList.push({data:"Secured a connection with @"+e.username,type:"notice",note:this.messageDate()}),this.clientList.push({clientId:e.clientId,username:e.username}),this.setState((function(e){return{messageListUpdated:e.messageListUpdated+1,clientListUpdated:e.clientListUpdated+1}})))}},{key:"onClientList",value:function(e){var t=this;this.mounted&&this.setState((function(n){var s,i=Object(a.a)(t.clientList);try{var r=function(){var n=s.value;e.find((function(e){return e.clientId===n.clientId}))||t.messageList.push({data:"Connection closed with @"+n.username,type:"notice",note:t.messageDate()})};for(i.s();!(s=i.n()).done;)r()}catch(o){i.e(o)}finally{i.f()}return t.clientList=e,{messageListUpdated:n.messageListUpdated+1,clientListUpdated:n.clientListUpdated+1}}))}},{key:"onClientMessage",value:function(e){this.mounted&&"t"===e.type&&(this.messageList.push({username:e.username,data:e.data,type:"text",note:this.messageDate()}),this.setState((function(e){return{messageListUpdated:e.messageListUpdated+1}})),this.props.addRouteEvent(this.props.channel.route))}},{key:"showClients",value:function(){this.setState({clientsVisible:!0})}},{key:"hideClients",value:function(){this.setState({clientsVisible:!1})}},{key:"render",value:function(){return u.a.createElement("div",{className:this.props.classes.root,style:{display:this.props.visible?"flex":"none"}},u.a.createElement(E,{ref:this.channelListRef,theme:this.props.theme,messageList:this.messageList,messageListUpdated:this.state.messageListUpdated}),u.a.createElement(j,{theme:this.props.theme,secured:this.state.secured,sendTextMessage:this.sendTextMessage,settingsSend:this.props.settingsSend}),u.a.createElement(N,{theme:this.props.theme,secured:this.state.secured}),u.a.createElement(z,{theme:this.props.theme,clientsVisible:this.state.clientsVisible,hideClients:this.hideClients,clientList:[{clientId:"me",username:this.props.channel.username}].concat(Object(s.a)(this.clientList)),clientListUpdated:this.state.clientListUpdated}))}}]),n}(u.a.Component);t.a=Object(p.a)((function(e){return{root:{height:"100%",flexDirection:"column",justifyContent:"flex-end"}}}))(F)},117:function(e,t,n){"use strict";var s=n(11),a=n(12),i=n(14),r=n(13),o=n(22),c=n(0),l=n.n(c),h=n(5),u=n(233),p=n(217),d=n(121),m=n(88),g=n(40),v=n(235),f=n(219),b=n(218),y=n(7),E=n(78),S=n(79),w=n(80),C=n(178),k=n(174),O=n(215),j=n(216),x=function(e){Object(i.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).setActiveRoute=a.setActiveRoute.bind(Object(y.a)(a)),a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.theme!==e.theme||this.props.activeRoute!==e.activeRoute||Object.entries(this.props.routeEvents).sort().toString()!==Object.entries(e.routeEvents).sort().toString()||this.props.channels.toString()!==e.channels.toString()}},{key:"setActiveRoute",value:function(e){this.props.setActiveRoute(e.currentTarget.getAttribute("route"))}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:this.props.classes.root},l.a.createElement(E.a,{key:"enter",route:"enter",button:!0,"aria-label":"Enter a channel",onClick:this.setActiveRoute},l.a.createElement(S.a,null,l.a.createElement(O.a,null)),l.a.createElement(w.a,{primary:"Enter a channel"})),l.a.createElement(C.a,{className:this.props.classes.list},this.props.channels.map((function(t){return l.a.createElement(E.a,{key:t.route,route:t.route,button:!0,"aria-label":"Channel "+t.channel,onClick:e.setActiveRoute},l.a.createElement(w.a,{primary:"#"+t.channel,disableTypography:!0,classes:{root:e.props.classes.text}}),l.a.createElement(k.a,{badgeContent:e.props.routeEvents[t.route]?e.props.routeEvents[t.route]:0,color:"secondary",overlap:"circle"}))}))),l.a.createElement(E.a,{key:"settings",route:"settings",button:!0,"aria-label":"Settings",onClick:this.setActiveRoute},l.a.createElement(S.a,null,l.a.createElement(j.a,null)),l.a.createElement(w.a,{primary:"Settings"})))}}]),n}(l.a.Component),R=Object(h.a)((function(e){return{root:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between"},list:{height:"100%"},text:{overflow:"hidden",textOverflow:"ellipsis"}}}))(x),M=function(e){Object(i.a)(n,e);var t=Object(r.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.theme!==e.theme||this.props.drawerVisible!==e.drawerVisible||this.props.activeRoute!==e.activeRoute||Object.entries(this.props.routeEvents).sort().toString()!==Object.entries(e.routeEvents).sort().toString()||this.props.channels.toString()!==e.channels.toString()}},{key:"render",value:function(){return l.a.createElement("nav",{className:this.props.classes.root},l.a.createElement(u.a,{mdUp:!0,implementation:"js"},l.a.createElement(p.a,{variant:"temporary",anchor:"left",open:this.props.drawerVisible,onClose:this.props.hideDrawer,classes:{paper:this.props.classes.paper},ModalProps:{keepMounted:!0}},l.a.createElement("div",{className:this.props.classes.drawer},l.a.createElement(d.a,{className:this.props.classes.toolbar},l.a.createElement(m.a,{edge:"start",color:"inherit","aria-label":"Close drawer",onClick:this.props.hideDrawer},l.a.createElement(b.a,null)),l.a.createElement(g.a,{variant:"h6",noWrap:!0,className:this.props.classes.title},"CHATCRYPT"),l.a.createElement(v.a,{alt:"ChatCrypt",variant:"square",src:"/logo-white.png"})),l.a.createElement(f.a,null),l.a.createElement(R,{theme:this.props.theme,activeRoute:this.props.activeRoute,setActiveRoute:this.props.setActiveRoute,routeEvents:this.props.routeEvents,channels:this.props.channels})))),l.a.createElement(u.a,{smDown:!0,implementation:"js"},l.a.createElement(p.a,{variant:"permanent",anchor:"left",open:!0,classes:{paper:this.props.classes.paper}},l.a.createElement("div",{className:this.props.classes.drawer},l.a.createElement(d.a,{className:this.props.classes.toolbar},l.a.createElement(g.a,{variant:"h6",noWrap:!0,className:this.props.classes.title},"CHATCRYPT"),l.a.createElement(v.a,{alt:"ChatCrypt",variant:"square",src:"/logo-white.png"})),l.a.createElement(f.a,null),l.a.createElement(R,{theme:this.props.theme,activeRoute:this.props.activeRoute,setActiveRoute:this.props.setActiveRoute,routeEvents:this.props.routeEvents,channels:this.props.channels})))))}}]),n}(l.a.Component);t.a=Object(h.a)((function(e){return{root:Object(o.a)({display:"flex"},e.breakpoints.up("md"),{width:"240px"}),paper:{width:"240px"},drawer:{flex:1,display:"flex",flexDirection:"column"},toolbar:{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main},title:{flexGrow:1}}}))(M)},118:function(e,t,n){"use strict";var s=n(11),a=n(12),i=n(7),r=n(14),o=n(13),c=n(22),l=n(0),h=n.n(l),u=n(5),p=n(180),d=n(76),m=n(231),g=n(222),v=n(215),f=n(40),b=n(220),y=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.theme!==e.theme}},{key:"render",value:function(){return h.a.createElement("div",null,h.a.createElement(f.a,{className:this.props.classes.text,variant:"h6",color:"textPrimary"},"USAGE"),h.a.createElement(f.a,{className:this.props.classes.text,variant:"body1",color:"primary"},"Each field has to contain at least one readable character."),h.a.createElement(f.a,{className:this.props.classes.text,variant:"body1"},"Pick a channel name and a secret password, then share it with those who you would like to chat with. These have to be the same for each member. Your username can be anything."),h.a.createElement(f.a,{className:this.props.classes.text,variant:"body2",color:"textSecondary"},"Note that none of the above details are stored anywhere, so you will have to remember them. Users entering a channel with the wrong password will not be prompted to enter the correct password, they will simply arrive into another channel - one which will be accessible with that particular wrong password."),h.a.createElement(f.a,{className:this.props.classes.text,variant:"body2",color:"secondary"},"Connection to the server is temporarily closed on mobile devices while the application runs in the background."," ",h.a.createElement(f.a,{className:this.props.classes.inline,component:"span",variant:"body2",color:"textSecondary"},"This is due to the power saving features of these devices and the nature of our solution, in which messages are not stored or queued for later transmission. You are participating in the conversation only while the application is in the foreground.")),h.a.createElement(f.a,{className:this.props.classes.text,variant:"body1",color:"textPrimary"},"Visit the main ",h.a.createElement(b.a,{href:"https://www.chatcrypt.com/",rel:"external noopener",target:"_blank",color:"primary"},"website")," for more information."))}}]),n}(h.a.Component),E=Object(u.a)((function(e){return{text:{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),paddingBottom:e.spacing(2)},inline:{display:"inline"}}}))(y),S=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={username:"",channel:"",password:""},a.updateUsername=a.updateUsername.bind(Object(i.a)(a)),a.updateChannel=a.updateChannel.bind(Object(i.a)(a)),a.updatePassword=a.updatePassword.bind(Object(i.a)(a)),a.handleKeyDown=a.handleKeyDown.bind(Object(i.a)(a)),a.enterChannel=a.enterChannel.bind(Object(i.a)(a)),a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.visible!==e.visible||this.props.theme!==e.theme||this.state.username!==t.username||this.state.channel!==t.channel||this.state.password!==t.password}},{key:"updateUsername",value:function(e){this.setState({username:e.target.value})}},{key:"updateChannel",value:function(e){this.setState({channel:e.target.value})}},{key:"updatePassword",value:function(e){this.setState({password:e.target.value})}},{key:"handleKeyDown",value:function(e){13!==e.keyCode||e.shiftKey||(e.preventDefault(),this.enterChannel())}},{key:"enterChannel",value:function(){this.state.username.match(/\S/)&&this.state.channel.match(/\S/)&&this.state.password.match(/\S/)&&this.props.channels.indexOf(this.state.channel.replace(/^\s+/,"").replace(/\s+$/,""))<0&&this.props.enterChannel(this.state.username.replace(/^\s+/,"").replace(/\s+$/,""),this.state.channel.replace(/^\s+/,"").replace(/\s+$/,""),this.state.password.replace(/^\s+/,"").replace(/\s+$/,""))&&this.setState({username:"",channel:"",password:""})}},{key:"render",value:function(){return h.a.createElement("div",{className:this.props.classes.root,style:{display:this.props.visible?"flex":"none"}},h.a.createElement(p.a,{disableGutters:!0,maxWidth:"sm"},h.a.createElement(d.a,{className:this.props.classes.paper,elevation:1},h.a.createElement(m.a,{className:this.props.classes.input,id:"username",fullWidth:!0,size:"medium",variant:"outlined",label:"Username",inputProps:{autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",maxLength:64},error:this.state.username.length>0&&!this.state.username.match(/\S/),value:this.state.username,onChange:this.updateUsername}),h.a.createElement(m.a,{className:this.props.classes.input,id:"channel",fullWidth:!0,size:"medium",variant:"outlined",label:"Channel",inputProps:{autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"},error:this.state.channel.length>0&&(!this.state.channel.match(/\S/)||this.props.channels.indexOf(this.state.channel.replace(/^\s+/,"").replace(/\s+$/,""))>-1),value:this.state.channel,onChange:this.updateChannel}),h.a.createElement(m.a,{className:this.props.classes.input,id:"password",fullWidth:!0,size:"medium",variant:"outlined",label:"Password",type:"password",inputProps:{autoComplete:"one-time-code",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"},error:this.state.password.length>0&&!this.state.password.match(/\S/),value:this.state.password,onChange:this.updatePassword,onKeyDown:this.handleKeyDown}),h.a.createElement(g.a,{className:this.props.classes.button,size:"large",fullWidth:!0,variant:"contained",color:"primary",endIcon:h.a.createElement(v.a,null),disabled:!this.state.username.match(/\S/)||!this.state.channel.match(/\S/)||!this.state.password.match(/\S/)||this.props.channels.indexOf(this.state.channel.replace(/^\s+/,"").replace(/\s+$/,""))>-1,"aria-label":"Enter",onClick:this.enterChannel},"ENTER")),h.a.createElement(E,{theme:this.props.theme})))}}]),n}(h.a.Component);t.a=Object(u.a)((function(e){var t;return{root:{height:"100%",overflow:"auto",paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},paper:{padding:e.spacing(2),marginTop:e.spacing(2),marginBottom:e.spacing(3)},input:(t={},Object(c.a)(t,"& fieldset",{borderRadius:"0px"}),Object(c.a)(t,"paddingBottom",e.spacing(2)),t),button:{borderRadius:"0px"}}}))(S)},132:function(e,t,n){e.exports=n(172)},150:function(e,t){},151:function(e,t){},172:function(e,t,n){"use strict";n.r(t);var s=n(24),a=n(11),i=n(12),r=n(7),o=n(14),c=n(13),l=n(0),h=n.n(l),u=n(15),p=n.n(u),d=n(104),m=n(230),g=n(115),v=n(229),f=n(107),b=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function y(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(171);var E=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).state={theme:"light"},s.setTheme=s.setTheme.bind(Object(r.a)(s)),s}return Object(i.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.theme!==t.theme}},{key:"componentDidMount",value:function(){this.setState((function(e){return{theme:localStorage.getItem("theme")?"dark"===localStorage.getItem("theme")?"dark":"light":e.theme}}))}},{key:"setTheme",value:function(e){localStorage.setItem("theme",e),this.setState({theme:e})}},{key:"render",value:function(){var e={light:"#20c020",main:"#20a020",dark:"#20e020"},t=Object(g.a)({palette:"dark"===this.state.theme?{type:"dark",primary:Object(s.a)(Object(s.a)({},e),{},{contrastText:"#ffffff"}),secondary:e,error:e,warning:e,info:e,success:e}:{type:"light"},overrides:{MuiCssBaseline:{"@global":{"*":{"user-select":"none","scrollbar-width":"none"},"input,textarea":{"user-select":"auto"},"*:hover":{"scrollbar-width":"thin"},"*::-webkit-scrollbar":{width:"6px",height:"6px"},"*::-webkit-scrollbar-thumb":{"background-color":"rgba(0,0,0,0)"},"*:hover::-webkit-scrollbar-thumb":{"background-color":"rgba(0,0,0,0.25)"}}}}});return h.a.createElement(v.a,{theme:t},h.a.createElement(m.a,null),h.a.createElement(f.a,{theme:this.state.theme,setTheme:this.setTheme}),h.a.createElement(d.a,null,h.a.createElement("meta",{name:"theme-color",content:"dark"===this.state.theme?"#20a020":"#3f51b5"})))}}]),n}(h.a.Component);p.a.render(h.a.createElement(h.a.StrictMode,null,h.a.createElement(E,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");b?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var s=n.headers.get("content-type");404===n.status||null!=s&&-1===s.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):y(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):y(t,e)}))}}()}},[[132,1,2]]]);
//# sourceMappingURL=main.cee30614.chunk.js.map